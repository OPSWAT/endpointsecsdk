///////////////////////////////////////////////////////////////////////////////////////////////
///  Sample Code for scan-vuln
///  Reference Implementation using OPSWAT Endpoint Vulnerability Module
///  
///  Created by Chris Seiler
///  OPSWAT OEM Solutions Architect
///////////////////////////////////////////////////////////////////////////////////////////////

using System;

namespace scan_vuln.sdk_pipe
{
    public class Util
    {
        // Note this is just passing in the json_result to be able to print it out on a failure
        public static void CheckSuccess(int rc)
        {
            // Return code link: https://software.opswat.com/OESIS_V4/html/c_return_codes.html
            // Note any code above 0 is a SUCCESS
            if (rc < 0)
            {
                Console.Out.WriteLine("Failed to execute call: " + rc);
                throw new Exception();
            }
        }
    }
}
